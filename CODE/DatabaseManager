from CreateTableCommand import CreateTableCommand
from ResetDBCommand import ResetDBCommand
from InsertCommand import InsertCommand
from SelectCommand import SelectCommand

class DatabaseManager:

    def __init__(self,bdd):
        self.bdd=bdd
        self.diskManager = bdd.disk_manager
        self.bufferManager = bdd.buffer_manager
        self.databaseInfo = bdd.data_base_info

    def Finish(self):
        self.databaseInfo.Finish()
        self.bufferManager.FlushAll()

    def createTable(self,cmd):
        typeComande = cmd.split(' ')
        if typeComande[0] == "CREATE" and typeComande[1] == "TABLE":
            return True
        else :
            return False
        
    def insert(self,cmd):
        typeComande = cmd.split(' ')
        if typeComande[0] == "INSERT":
            return True
        else :
            return False
        
    def select(self,cmd):
        typeComande = cmd.split(' ')
        if typeComande[0] == "SELECT":
            return True
        else :
            return False

    def reset(self,cmd):
        typeComande = cmd.split(' ')
        if typeComande[0] == "RESETDB":
            return True
        else :
            return False

    def ProcessCommand(self, cmd : str):
        
        if self.createTable(cmd):
            CreateTableCommand(cmd).Execute()
            print("-------------CREATION DE TABLE-----------")
        if self.reset(cmd):
            ResetDBCommand(cmd).Reset()
            print("-------------RESETDB-----------")
        if self.insert(cmd):
            InsertCommand(cmd).Execute()
            print("-------------INSERTION-----------")
        if self.select(cmd):
            SelectCommand(cmd).Execute()
            print("-------------SELECTION-----------")
        if '':
            print()