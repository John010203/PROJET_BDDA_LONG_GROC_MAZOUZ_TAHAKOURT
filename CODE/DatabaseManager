from CreateTableCommand import CreateTableCommand
from CreateTableCommand import parseCommandeCreateTable
from TableInfo import TableInfo
class DatabaseManager:

    def __init__(self,bdd):
        self.bdd=bdd
        self.diskManager = bdd.disk_manager
        self.bufferManager = bdd.buffer_manager
        self.databaseInfo = bdd.data_base_info

    def Finish(self):
        self.databaseInfo.Finish()
        self.bufferManager.FlushAll()

    def ProcessCommand(self, cmd : str):
        match(cmd):
            case 'CREATE TABLE':
                commande = parseCommandeCreateTable(cmd)
                self.bdd.databaseInfo.AddTableInfo(TableInfo(commande[0],commande[1],commande[2]))
                #on parse
                #on appelle la classe CreateTableCommand
                print()
            case 'ADD':
                print()
            case 'INSERT':
                print()
            case 'SELECT':
                print()
            case '':
                print()
            case 'WHERE':
                print()